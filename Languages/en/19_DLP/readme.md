- $3^2 \equiv 4 \pmod{5}$

- $3^3 \equiv 2 \pmod{5}$

Therefore, in $Z^*_5$, $3 = \log_3{2}$.

Here's a challenging example: For $Z^*_{31}$, find an integer $x$ that satisfies $13^x \equiv 17 \pmod{31}$. You can try it out. As $n$ continues to increase, the difficulty will also increase.

### 4.2 Applications in Cryptography

The discrete logarithm problem has wide applications in cryptography, especially in public key cryptography. Here are some examples:

1. **RSA encryption algorithm:** We have introduced the [RSA algorithm](https://github.com/WTFAcademy/WTF-zk/blob/main/MS01_RSA/readme.md) in our milestone course on number theory. It is an asymmetric encryption algorithm based on the hardness of integer factorization and the discrete logarithm problem.

2. **Diffie-Hellman key exchange:** The Diffie-Hellman key exchange protocol is a method for negotiating keys over an insecure communication channel. It is based on the discrete logarithm problem, where two communicating parties choose a large prime number and a generator, and then each selects a private key. The public key is derived by performing the discrete logarithm operation on the generator, and the shared key is computed in the end. The hardness of the discrete logarithm problem ensures that even if an attacker intercepts the public information, it is difficult to derive the private key.

3. **ElGamal encryption algorithm:** The ElGamal encryption algorithm is a public key encryption algorithm based on the discrete logarithm problem. In ElGamal encryption, the encryptor chooses a generator and a private key, and the public key is generated by performing the discrete logarithm operation on the generator. The decryptor uses their private key for decryption. The hardness of the discrete logarithm problem ensures the security of the algorithm.

4. **Elliptic curve cryptography:** Elliptic curve cryptography uses points on an elliptic curve for encryption and signing. The elliptic curve discrete logarithm problem (ECDLP) is the intractable problem of finding points on an elliptic curve. Elliptic curve cryptography provides more efficient encryption algorithms compared to traditional RSA, while offering the same or higher level of security.

## 5. Summary

In this lecture, we introduced primitive roots and the discrete logarithm problem. A primitive root is a generator of the multiplicative group modulo $n$ and is important in number theory. The discrete logarithm problem is closely related to primitive roots and is a significant challenge in cryptography, as the security of many encryption algorithms relies on the difficulty of the discrete logarithm problem.

With this, we conclude the content on group theory in the WTF zk tutorial. Next, we will study the topics of ring theory and field theory!
# WTF zk Tutorial 19: Discrete Logarithm Problem

In this tutorial, we will explore primitive roots and the discrete logarithm problem. The discrete logarithm problem serves as the foundation for many encryption algorithms.

### 1. Multiplicative Order

We usually discuss the concept of primitive roots in the multiplicative group modulo n, denoted as Z_n^*. Therefore, before introducing the definition of a primitive root, let's first talk about the multiplicative order.

**Definition of Multiplicative Order:** In the group Z_n^*, for any element a, its multiplicative order is defined as the smallest positive integer k such that a^k â‰¡ 1 (mod n). The multiplicative order is usually denoted as ord_n(a).

In simpler terms, the multiplicative order is the minimum number of times an element needs to be multiplied with itself to obtain the group's identity element.

For example, consider the multiplicative group modulo 5, Z_5^* = {1,2,3,4}. We can verify that the multiplicative order of 4 is 2 because:

- 4^1 â‰¡ 4 (mod 5)
- 4^2 â‰¡ 1 (mod 5)

## 2. Primitive Roots

**Definition of a Primitive Root:** For an element g in Z^*_n, if the various powers of g can generate all the elements in the group Z^*_n, then g is called a primitive root of Z^*_n.

In other words, for every a âˆˆ Z_n^*, there exists an integer k such that g^k â‰¡ a (mod n).

The concept of a primitive root is closely related to the generator of a cyclic group: while the multiplicative group modulo n is not necessarily a cyclic group, when it is a cyclic group, a primitive root serves as its generator. Therefore, the properties of a generator can also be applied to a primitive root. The order (multiplicative order) of a primitive root is equal to the order of Z^*_n, which is Ï†(n).

For example, consider the multiplicative group modulo 7, Z_7^* = {1, 2, 3, 4, 5, 6}. We can verify that 3 is a primitive root because:

- 3^1 â‰¡ 3 (mod 7)
- 3^2 â‰¡ 2 (mod 7)
- 3^3 â‰¡ 6 (mod 7)
- 3^4 â‰¡ 4 (mod 7)
- 3^5 â‰¡ 5 (mod 7)
- 3^6 â‰¡ 1 (mod 7)

In this example, the powers of 3 generate all the elements in the group Z_7^*.

As another example, consider the multiplicative group modulo 8, Z_8^* = {1, 3, 5, 7}. Let's calculate the powers of its elements:

- 1^1 â‰¡ 1 (mod 8)
- 3^1 â‰¡ 3 (mod 8), 3^2 â‰¡ 1 (mod 8)
- 5^1 â‰¡ 5 (mod 8), 5^2 â‰¡ 1 (mod 8)
- 7^1 â‰¡ 7 (mod 8), 7^2 â‰¡ 1 (mod 8)

We can see that none of the powers of the elements can generate the entire group, which means Z_8^* has no primitive roots and is not a cyclic group.

### 2.1 Properties of Primitive Roots

**Property 1. Existence of Primitive Roots:** A primitive root exists in Z_n^* if and only if n is of the form 2, 4, p^k, or 2p^k, where p is an odd prime and k is a positive integer.

The proof of this property is complex and beyond the scope of this tutorial. Just remember the conclusion.

For example, Z_5^* has a primitive root, such as 2; Z_7^* also has a primitive root, such as 3. Both of these are cyclic groups. However, Z_8^* has no primitive roots and is not a cyclic group because 8 = 2^3 does not satisfy the form n = 2, 4, p^k, or 2p^k.

**Property 2. Number of Primitive Roots:** When Z_n^* has a primitive root (n = 2, 4, p^k, 2p^k), the number of primitive roots is Ï†(Ï†(n)).

<details><summary>Click to expand the proofðŸ‘€</summary>

Assume g is a primitive root of Z_n^*, and its order is equal to the order of the group Z_n^*, which is Ï†(n). According to Property 5 of the order of a cyclic group, the number of generators is Ï†(Ï†(n)). Proof complete.

</details>

For example, Z_5^* has Ï†(Ï†(5)) = Ï†(4) = 2^2-2 = 2 primitive roots.

**Property 3. Corollary of the Number of Primitive Roots:** When p is a prime number, the number of primitive roots in Z_p^* is Ï†(p-1).

<details><summary>Click to expand the proofðŸ‘€</summary>

When p is a prime number, Ï†(p) = p-1. According to the previous property, the number of primitive roots in Z_p^* is Ï†(p-1).

</details>

**Property 4. Relationship between Multiplicative Order and Euler's Totient Function:** For a âˆˆ Z^*_n, ord_n(a) divides Ï†(n).

<details><summary>Click to expand the proofðŸ‘€</summary>

The order of Z_n^* is Ï†(n). According to Property 6 of the order of a cyclic group, the order of the element a divides the order of the group, which means ord_n(a) divides Ï†(n). Proof complete.

</details>

## 3. Discrete Logarithm

The discrete logarithm is usually discussed in the multiplicative group modulo n, denoted as Z^*_n. When n is in the form 2, 4, p^k, or 2p^k, Z^*_n is a cyclic group, and a primitive root exists.

For the group Z^*_n, with a primitive root g and an element a, the discrete logarithm log_gb is the value of x such that g^x â‰¡ a. It is denoted as x = log_gb.

### 3.1 Properties of Discrete Logarithm

**Property 1. Relationship between Discrete Logarithm and Euler's Totient Function:** For the group Z^*_n, if gcd(g, n) = 1, then a â‰¡ g^r (mod n) if and only if log_ga â‰¡ r (mod Ï†(n)), which means the discrete logarithm is congruent to r modulo Ï†(n).

<details><summary>Click to expand the proofðŸ‘€</summary>

**Necessity**

Let x = log_ga. According to a â‰¡ g^r (mod n), we have g^x â‰¡ g^r (mod n). According to Euler's theorem: If integers a and n are coprime (i.e., gcd(g,n)=1), then g^Ï†(n) â‰¡ 1 (mod n). This means that we can multiply g^Ï†(n) anywhere in the equation, and the congruence still holds. For any integer k, we have g^x â‰¡ g^r g^(kÏ†(n)) â‰¡ g^(r + kÏ†(n)) (mod n), which means x = r + kÏ†(n), or x â‰¡ r (mod Ï†(n)). Proof complete.

**Sufficiency**

If x â‰¡ r (mod Ï†(n)), which means x = r + kÏ†(n). We have g^x â‰¡ g^(r + kÏ†(n)) â‰¡ g^r g^(kÏ†(n)) (mod n) holds. According to Euler's theorem, g^Ï†(n) = 1, so we have g^x â‰¡ g^r (mod n).

</details>

For example, consider Z^*_5, which has a primitive root g = 2, and Ï†(5) = 4. We have 4 â‰¡ 2^2 (mod 5), so 4 â‰¡ 2^6 (mod 5) and 4 â‰¡ 2^10 (mod 5) also hold. You can add or subtract any multiple of Ï†(n) to the exponent, and the congruence relation still holds modulo n.

We can also use this property to simplify the calculation of modular exponentiation. For Z^*_7, let's take 3 as the primitive root, and Ï†(7) = 6. We have 3^100 â‰¡ 3^(100 mod 6) â‰¡ 3^(4 mod 6) â‰¡ 81 â‰¡ 4 (mod 7).

## 4. Discrete Logarithm Problem

The Discrete Logarithm Problem (DLP) deals with finding the discrete logarithm x such that a â‰¡ g^x (mod n) for a given generator g and element a in the group Z^*_p where p is a prime. This problem is computationally challenging, as currently there are no known efficient algorithms to solve it in polynomial time.

### 4.1 Difficulty of the Problem

Forward computation is easy: given a and x, computing a^x is straightforward and can be done using efficient algorithms.

However, reverse computation is difficult: given a and b, computing x = log_a(b) is extremely challenging due to the following reasons:

1. Nonlinearity: The group's multiplication operation is usually a non-linear operation, and finding the exponent that satisfies the condition typically requires iterating through the entire group.

2. No efficient algorithms: When n is a large prime, no algorithm has been discovered to solve this problem in polynomial time.

3. Large search space: The difficulty of the discrete logarithm problem also depends on the existence of primitive roots. When the modulus n has a primitive root, the discrete logarithm problem is typically difficult because the powers of the primitive root form a complete residue system modulo n. Conversely, if there are no primitive roots, the solution to the discrete logarithm problem may be easier to find.

Let's take a simple example: for Z^*_5, find the integer x that satisfies 3^x â‰¡ 2 (mod 5). We can iterate through the powers of 3: